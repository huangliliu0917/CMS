<!DOCTYPE html>
<!--
  ~ 版权所有:杭州火图科技有限公司
  ~ 地址:浙江省杭州市滨江区西兴街道阡陌路智慧E谷B幢4楼
  ~
  ~ (c) Copyright Hangzhou Hot Technology Co., Ltd.
  ~ Floor 4,Block B,Wisdom E Valley,Qianmo Road,Binjiang District
  ~ 2013-2016. All rights reserved.
  -->

<html xmlns:cms="http://cms.huobanplus.com" xmlns:th="http://www.thymeleaf.org" lang="en">
<!--/*@thymesVar id="widgetId" type="java.lang.String"*/-->
<head>
    <meta charset="UTF-8">
    <title>Demo Editor</title>

    <link rel="stylesheet" href="http://resali.huobanplus.com/cdn/bootstrap/3.3.6/css/bootstrap.min.css">

    <link rel="stylesheet" href="../../../../../manage-service/src/main/resources/web/public/assets/css/edit.css"
          th:href="'/manage-resources/assets/css/edit.css'">
    <link rel="stylesheet" href="http://resali.huobanplus.com/cdn/font-awesome/4.6.3/css/font-awesome.min.css">
    <link rel="stylesheet"
          href="http://resali.huobanplus.com/cdn/jquery.dataTables/1.10.12/css/dataTables.bootstrap.min.css">
    <link rel="stylesheet" href="http://resali.huobanplus.com/cdn/jquery-upload-file/4.0.10/css/uploadfile.css">
    <link rel="stylesheet" href="http://resali.huobanplus.com/cdn/swiper/3.3.1/css/swiper.min.css">
    <link rel="stylesheet" href="http://resali.huobanplus.com/cdn/zTree//3.5.24/css/metroStyle/metroStyle.css"
          type="text/css">
    <link rel="stylesheet"
          href="http://resali.huobanplus.com/cdn/jquery-bigcolorpicker/2.5.1/css/jquery.bigcolorpicker.css">
    <link rel="stylesheet" href="../../../../../manage-service/src/main/resources/web/public/assets/css/widgets.css"
          th:href="'/manage-resources/assets//css/widgets.css'">
    <!--[if lt IE 9]>
    <script src="http://resali.huobanplus.com/cdn/bracket/js/html5shiv.js"></script>
    <script src="http://resali.huobanplus.com/cdn/bracket/js/respond.min.js"></script>
    <![endif]-->
</head>
<body>

<div id="editor">
    <button class="btn btn-success" id="editorSaver">Save me!</button>
    <button class="btn btn-success" id="editorInit">init me!</button>
    <br>
    <!--${properties} should be supported-->
    <span id="previewRegion">
        nothing
    </span>
    <div class="conf-body">
        <div cms:replaceEditor="${widgetId},${properties}"></div>
    </div>
    <script type="text/neo-template" id="templateHtml">
        <div class="modal fade" id="selectDataTable" tabindex="-1" role="dialog" aria-labelledby="myModalLabel"
             aria-hidden="true">
            <div class="modal-dialog modal-lg">
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal"
                                aria-hidden="true">×
                        </button>
                        <h4 class="modal-title" id="myModalLabel">添加图片</h4>
                    </div>
                    <div class="modal-body">
                        <ul class="nav nav-tabs" role="tablist">
                            <li role="presentation" class="active">
                                <a href="#selectDataList" role="tab" data-toggle="tab">选择图片</a>
                            </li>
                            <li role="presentation">
                                <a href="#selectDataUpload" role="tab" data-toggle="tab">新增图片</a>
                            </li>
                        </ul>
                        <div class="tab-content">
                            <div role="tabpanel" class="tab-pane active" id="selectDataList">
                                <table id="js-selectTable" class="table table-hover" width="100%"></table>
                            </div>
                            <div role="tabpanel" class="tab-pane" id="selectDataUpload">
                                <div id="js-fileUploader">Upload</div>
                            </div>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" data-toggle="#selectDataList" class="btn btn-primary js-select-btn">确认
                        </button>
                        <button type="button" data-toggle="#selectDataUpload"
                                class="btn btn-primary hidden js-uploader-btn">确认
                        </button>
                        <button type="button" class="btn btn-default js-cancel-btn" data-dismiss="modal">关闭</button>
                    </div>
                </div>
            </div>
        </div>
    </script>
</div>

<script th:inline="javascript">
    var initPath = /*[['/manage-resources/assets/js/data/widget.json']]*/ '../../../../../manage-service/src/main/resources/web/public/assets/js/data/widget.json';
    var savePage = /*[[@{/manage/pages/}]]*/ null;
</script>

<script src="http://resali.huobanplus.com/cdn/jquery/2.2.4/jquery.min.js"></script>
<script src="http://resali.huobanplus.com/cdn/bootstrap/3.3.6/bootstrap.min.js"></script>
<script src="http://resali.huobanplus.com/cdn/jquery-form/3.51/jquery.form.min.js"></script>
<script src="http://resali.huobanplus.com/cdn/bracket/js/jquery-ui-1.10.3.min.js"></script>
<script src="http://resali.huobanplus.com/cdn/layer/2.3/layer.js"></script>
<script src="http://resali.huobanplus.com/cdn/jquery-upload-file/4.0.10/jquery.uploadfile.min.js"></script>
<script src="http://resali.huobanplus.com/cdn/zTree/3.5.24/jquery.ztree.all.min.js"></script>
<script src="http://resali.huobanplus.com/cdn/web-storage-cache/1.0.1/web-storage-cache.min.js"></script>
<script src="http://resali.huobanplus.com/cdn/swiper/3.3.1/swiper.jquery.min.js"></script>
<script src="http://resali.huobanplus.com/cdn/jquery-bigcolorpicker/2.5.1/jquery.bigcolorpicker.js"></script>
<script src="http://resali.huobanplus.com/cdn/jquery.mCustomScrollbar/3.1.5/jquery.mCustomScrollbar.min.js"></script>
<script src="http://resali.huobanplus.com/cdn/jquery.dataTables/1.10.12/jquery.dataTables.min.js"></script>
<script src="http://resali.huobanplus.com/cdn/jquery.dataTables/1.10.12/dataTables.bootstrap.min.js"></script>

<script src="../../../../../manage-service/src/main/resources/web/public/assets/libs/jquery.htmlClean.js"
        th:src="'/manage-resources/assets/libs/jquery.htmlClean.js'"></script>
<script src="../../../../../manage-service/src/main/resources/web/public/assets/js/page/cms.editPage.js"
        th:src="'/manage-resources/assets/js/page/cms.editPage.js'"></script>
<script src="../../../../../manage-service/src/main/resources/web/public/assets/js/cms.addEdit.js"
        th:src="'/manage-resources/assets/js/cms.addEdit.js'"></script>
<!--<script src="../../../../../manage-service/src/main/resources/web/public/assets/js/data/cms.dataHandle.js"-->
<!--th:src="'/manage-resources/assets/js/data/cms.dataHandle.js'"></script>-->
<script src="../../../../../manage-service/src/main/resources/web/public/assets/js/common.js"
        th:src="'/manage-resources/assets/js/common.js'"></script>
<script src="../../../../../manage-service/src/main/resources/web/public/assets/js/cms.widgets.js"
        th:src="'/manage-resources/assets/js/cms.widgets.js'"></script>


<script th:inline="javascript">
    var _widgetProperties = {};
    function widgetProperties() {
        return _widgetProperties;
    }

    var _successProperties;
    var _failedMessage;

    /*<![CDATA[*/
    var CMSDebugMode = /*[[${@configInfo.debugging}]]*/ false;
    var testMode = /*[[${@environment.acceptsProfiles('test')}]]*/ true;
    var scope = /*[[${widgetId}]]*/ null;
    var _CMS_DataSource_URI = /*[[@{/dataSource/}]]*/ null;
    var imageMock = '/manage-resources/assets/js/data/imageMock.json';
    var linkMock = '/manage-resources/assets/js/data/linkMock.json';
    var uploadMock = '/manage-resources/assets/js/data/uploadMock.json';
    var debug = true;
    /*]]>*/
    $('#editorSaver').click(function () {
        _failedMessage = null;
        CMSWidgets.saveComponent('previewRegion', {
            onSuccess: function (ps) {
                _successProperties = ps;
            }, onFailed: function (msg) {
                _failedMessage = msg;
                console.error("save error", msg);
            }
        });
    });
    $('#editorInit').click(function () {
        CMSWidgets.openEditor('previewRegion', scope);
//        window[scope].init(1);
//        console.error("init error");
    });

    //    CMSWidgets.pushNextWidgetIdentity(scope);
</script>
<script th:src="@{/widget/{id}(id=${widgetId+'.js'})}"></script>

</body>
</html>