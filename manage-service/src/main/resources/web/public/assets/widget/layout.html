<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
        "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
    <title></title>
    <link  href="/assets/css/layout.css?v=1.0"  type="text/css" rel="stylesheet"/>
    <link  href="/assets/libs/layer/skin/layer.css?v=1.2"  type="text/css" rel="stylesheet"/>
    <script type="application/javascript" src="/assets/js/jquery-1.11.1.min.js"></script>
    <script type="application/javascript" src="/assets/libs/layer/layer.js?v=1.0"></script>
    <script type="application/javascript" src="/assets/libs/layer/extend/layer.ext.js?v=1.0"></script>
    <script type="application/javascript" src="/assets/widget/widgetData.js?v=1.2"></script>
</head>
<body>
<div class="J-content dialog-area">
    <div id="addlayout">
        <div class="msg-box-page">
            <div class="msg-tips-page"><em></em><span class="msg-content-page">友情提示：单击可直接完成添加操作噢！</span></div>
        </div>
        <!--selectlayout-->
        <div class="select-layout">
            <ul id="selectlayout">
                <li>
                    <span data-typeid="0" class="J-select-layout" style="background:url(/assets/img/layout/uleqYbReyXn9M1FU.jpg)"></span>
                    <em>三栏布局（190x590x190）</em>
                </li>
                <li>
                    <span data-typeid="1" class="J-select-layout" style="background:url(/assets/img/layout/FPFVakoUJeLlt89G.png)"></span>
                    <em>通栏布局（990）</em>
                </li>
                <li>
                    <span data-typeid="2" class="J-select-layout" style="background:url(/assets/img/layout/R72PP1sMUrG3ETSm.jpg)"></span>
                    <em>左右栏布局（190x790）</em>
                </li>
                <li>
                    <span data-typeid="3" class="J-select-layout" style="background:url(/assets/img/layout/PELAo3qNchTeGT1D.png)"></span>
                    <em>右等分布局（190x390x390）</em>
                </li>
                <li>
                    <span data-typeid="4" class="J-select-layout" style="background:url(/assets/img/layout/vtP1gOCRgy35mBaY.jpg)"></span>
                    <em>左右栏布局（790X190）</em>
                </li>
                <li>
                    <span data-typeid="5" class="J-select-layout" style="background:url(/assets/img/layout/rBEGEk92dZEIAAAAAAAEfT8CspsAAAADgP_-uQAAAUc355.png)"></span>
                    <em>左等分布局（390x390x190）</em>
                </li>
                <li>
                    <span data-typeid="6" class="J-select-layout" style="background:url(/assets/img/layout/uleqYbReyXn9M1FU.jpg)"></span>
                    <em>三栏布局-it（254x717x239）</em>
                </li>
                <li>
                    <span data-typeid="7" class="J-select-layout" style="background:url(/assets/img/layout/R72PP1sMUrG3ETSm.jpg)"></span>
                    <em>左右布局-lt（254x956）</em>
                </li>
                <li>
                    <span data-typeid="8" class="J-select-layout" style="background:url(/assets/img/layout/R72PP1sMUrG3ETSm.jpg)"></span>
                    <em>左右栏布局-it（272x718）</em>
                </li>
                <li>
                    <span data-typeid="9" class="J-select-layout" style="background:url(/assets/img/layout/R72PP1sMUrG3ETSm.jpg)"></span>
                    <em>左右布局（215X765）</em>
                </li>
                <li>
                    <span data-typeid="10" class="J-select-layout" style="background:url(/assets/img/layout/rBEGFU-nm50IAAAAAAAIfrSAztkAAA4ywKQY5kAAAiW444.jpg)"></span>
                    <em>左右栏布局（330x650）</em>
                </li>
                <li>
                    <span data-typeid="11" class="J-select-layout" style="background:url(http://img30.360buyimg.com/cms/g1/M00/04/11/rBEGD0-nnGEIAAAAAAAG3uiiinIAAA4ywCNd9wAAAb2543.gif)"></span>
                    <em>左右栏布局（650x330）</em>
                </li>
                <li>
                    <span data-typeid="12" class="J-select-layout" style="background:url(http://img14.360buyimg.com/cms/g7/M00/11/02/rBEHZVDRcq4IAAAAAAAEfTD3H7AAADVmwP_-YEAAASV789.png)"></span>
                    <em>左右等分布局（490 x 490）</em>
                </li>
                <li>
                    <span data-typeid="13" class="J-select-layout" style="background:url(http://img12.360buyimg.com/cms/g8/M02/11/02/rBEHaFDRcu8IAAAAAAAEfFyZp5UAADVngLmkZ4AAASU359.png)"></span>
                    <em>左中右等分布局（323 x 324 x 323）</em>
                </li>
                <li>
                    <span data-typeid="14" class="J-select-layout current" style="background:url(http://img13.360buyimg.com/cms/g10/M00/0B/17/rBEQWFFaNDAIAAAAAAAG3ISr5NsAACSrwAdwc0AAAb0365.jpg)"></span>
                    <em>通栏布局（100%）</em>
                </li>
            </ul>
        </div>
    </div>
</div>
<script type="application/javascript">
    var obj=$(".J-select-layout");
    var index = parent.layer.getFrameIndex(window.name); //获取窗口索引
    $.each(obj,function(item,dom){
        $(dom).click(function(){
            var indexLoad = layer.load(1, {
                shade: [0.6,'#000000'] //0.1透明度的白色背景
            });
            var typeId=$(dom).data('typeid');
            var url="/layout/"+typeId;
            $.ajax({
                url: url,
                type: "POST",
                dataType: 'json',
                success: function (data) {
                    if(data!=null) {
                        if (data.code == 200) {
                            var moduleCount=data.data.moduleCount;
                            var module=addModule(moduleCount);
                            var layoutObj={
                                layoutId:data.data.id,
                                layoutType:typeId,
                                module:module
                            };
                            var layoutJson=JSON.stringify(layoutObj)
                            widgetData.saveLayout(layoutJson);
//                            var dom=parent.$('#js_layout_json_value');
//                            if(typeof dom=="undefined"||dom.length<=0){
//                                parent.$("body").append("<input type='hidden' id='js_layout_json_value' value='"+layoutJson+"'/>");
//                            }else{
//                                parent.$("#js_layout_json_value").val(layoutJson);
//                            }
                            parent.$(".js-layout-add").before(data.data.template);
                        }
                    }else{
                        layer.msg("获得布局失败...", {
                            icon: 1,
                            time: 2000 //2秒关闭（如果不配置，默认是3秒）
                        });
                    }
                    layer.close(indexLoad);
                    parent.layer.close(index);
                },error:function(){
                    layer.close(indexLoad);
                    parent.layer.close(index);
                }
            });
        });
    })
    function addModule(moduleCount){
        var module=new Array();
        for(var i=0;i<moduleCount;i++){
            module.push({position:i,widget:[]});
        }
        return module;
    }
</script>
</body>
</html>