<!DOCTYPE html>
<!--
  ~ 版权所有:杭州火图科技有限公司
  ~ 地址:浙江省杭州市滨江区西兴街道阡陌路智慧E谷B幢4楼
  ~
  ~ (c) Copyright Hangzhou Hot Technology Co., Ltd.
  ~ Floor 4,Block B,Wisdom E Valley,Qianmo Road,Binjiang District
  ~ 2013-2016. All rights reserved.
  -->

<html xmlns:cms="http://cms.huobanplus.com" xmlns:th="http://www.thymeleaf.org" lang="en">
<!--/*@thymesVar id="widgetId" type="java.lang.String"*/-->
<head>
    <meta charset="UTF-8">
    <title>Demo Editor</title>

    <link rel="stylesheet" href="http://resali.huobanplus.com/cdn/bootstrap/3.3.6/css/bootstrap.min.css">

    <link rel="stylesheet" href="../../../../../manage-service/src/main/resources/web/public/assets/css/edit.css"
          th:href="'/manage-resources/assets/css/edit.css'">
    <link rel="stylesheet" href="../../../../../manage-service/src/main/resources/web/public/assets/css/fontello.css"
          th:href="'/manage-resources/assets/css/fontello.css'">

    <link rel="stylesheet" href="http://resali.huobanplus.com/cdn/jquery-upload-file/4.0.10/css/uploadfile.css">
    <link rel="stylesheet"
          href="http://resali.huobanplus.com/cdn/bootstrap-treeview/1.2.0/css/bootstrap-treeview.min.css">
    <link rel="stylesheet" href="http://resali.huobanplus.com/cdn/swiper/3.3.1/css/swiper.min.css">

    <!--[if lt IE 9]>
    <script src="http://resali.huobanplus.com/cdn/bracket/js/html5shiv.js"></script>
    <script src="http://resali.huobanplus.com/cdn/bracket/js/respond.min.js"></script>
    <![endif]-->
</head>
<body>

<div id="editor">
    <button id="editorSaver">Save me!</button>
    <button id="editorInit">init me!</button>
    <!--${properties} should be supported-->
    <span id="previewRegion">
        nothing
    </span>
    <div cms:replaceEditor="${widgetId},${properties}"></div>

</div>

<script th:inline="javascript">
    var initPath = /*[['/manage-resources/assets/js/data/widget.json']]*/ '../../../../../manage-service/src/main/resources/web/public/assets/js/data/widget.json';
    var savePage = /*[[@{/manage/pages/}]]*/ null;
</script>

<script src="http://resali.huobanplus.com/cdn/jquery/2.2.4/jquery.min.js"></script>
<script src="http://resali.huobanplus.com/cdn/jquery-form/3.51/jquery.form.min.js"></script>
<script src="http://resali.huobanplus.com/cdn/bracket/js/jquery-ui-1.10.3.min.js"></script>
<script src="http://resali.huobanplus.com/cdn/layer/2.3/layer.js"></script>
<script src="http://resali.huobanplus.com/cdn/jquery-upload-file/4.0.10/jquery.uploadfile.min.js"></script>
<script src="http://resali.huobanplus.com/cdn/bootstrap-treeview/1.2.0/bootstrap-treeview.min.js"></script>
<script src="http://resali.huobanplus.com/cdn/web-storage-cache/1.0.1/web-storage-cache.min.js"></script>
<script src="http://resali.huobanplus.com/cdn/swiper/3.3.1/swiper.jquery.min.js"></script>
<script src="../../../../../manage-service/src/main/resources/web/public/assets/libs/jquery.htmlClean.js"
        th:src="'/manage-resources/assets/libs/jquery.htmlClean.js'"></script>
<script src="../../../../../manage-service/src/main/resources/web/public/assets/js/page/editPage.js"
        th:src="'/manage-resources/assets/js/page/editPage.js'"></script>
<!--<script src="../../../../../manage-service/src/main/resources/web/public/assets/js/data/dataHandle.js"-->
<!--th:src="'/manage-resources/assets/js/data/dataHandle.js'"></script>-->
<script src="../../../../../manage-service/src/main/resources/web/public/assets/js/common.js"
        th:src="'/manage-resources/assets/js/common.js'"></script>
<script src="../../../../../manage-service/src/main/resources/web/public/assets/js/cms.widgets.js"
        th:src="'/manage-resources/assets/js/cms.widgets.js'"></script>

<script th:inline="javascript">
    var _widgetProperties = {};
    function widgetProperties() {
        return _widgetProperties;
    }

    var _successProperties;
    var _failedMessage;

    /*<![CDATA[*/
    var CMSDebugMode = /*[[${@configInfo.debugging}]]*/ false;
    var testMode = /*[[${@environment.acceptsProfiles('test')}]]*/ true;
    var scope = /*[[${widgetId}]]*/ null;
    var _CMS_DataSource_URI = /*[[@{/dataSource/}]]*/ null;
    /*]]>*/
    $('#editorSaver').click(function () {
        _failedMessage = null;
        CMSWidgets.saveComponent('previewRegion', {
            onSuccess: function (ps) {
                _successProperties = ps;
            }, onFailed: function (msg) {
                _failedMessage = msg;
                console.error("save error", msg);
            }
        });

    });

    $('#editorInit').click(function () {
        CMSWidgets.openEditor('previewRegion', scope);
//        window[scope].init(1);
//        console.error("init error");
    });

    //    CMSWidgets.pushNextWidgetIdentity(scope);
</script>
<script th:src="@{/widget/{id}(id=${widgetId+'.js'})}"></script>

</body>
</html>